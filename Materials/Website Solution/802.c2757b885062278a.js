"use strict";(self.webpackChunkangles_on_books=self.webpackChunkangles_on_books||[]).push([[802],{7802:(A,p,r)=>{r.r(p),r.d(p,{ReviewsModule:()=>k});var s=r(3272),a=r(1953),c=r(4583);class w{constructor(i,t){this.content=i,this.bookId=t}}var g=r(9237),u=r(1342),d=r(8609),e=r(5402),m=r(1899),h=r(3925);let f=(()=>{class o{constructor(t){this.httpClient=t}getReviews(t){return this.httpClient.get(`${m.N.url}/Reviews/${t}`)}getBook(t){return this.httpClient.get(`${m.N.url}/Books/${t}`)}addReview(t){return this.httpClient.post(`${m.N.url}/Reviews`,t)}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(h.eN))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function R(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," Review must have content "),e.qZA())}function b(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," Review must be at least 5 characters long "),e.qZA())}function C(o,i){if(1&o&&(e.TgZ(0,"div",7),e.YNc(1,R,2,0,"div",8),e.YNc(2,b,2,0,"div",8),e.qZA()),2&o){e.oxw();const t=e.MAs(6);e.xp6(1),e.Q6J("ngIf",null==t.errors?null:t.errors.required),e.xp6(1),e.Q6J("ngIf",null==t.errors?null:t.errors.minlength)}}let Z=(()=>{class o{constructor(){this.bookId=0,this.createReview=new e.vpe}ngOnInit(){this.review=new w("",this.bookId)}submit(){this.createReview.emit(this.review)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-review-form"]],inputs:{bookId:"bookId"},outputs:{createReview:"createReview"},decls:10,vars:3,consts:[["name","reviewForm",1,"form-inline",3,"ngSubmit"],["reviewForm","ngForm"],[1,"form-group"],["minlength","5","type","text","required","","name","content",1,"form-control",3,"ngModel","ngModelChange"],["content","ngModel"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","alert alert-danger",4,"ngIf"],[1,"alert","alert-danger"],[4,"ngIf"]],template:function(t,n){if(1&t&&(e.TgZ(0,"form",0,1),e.NdJ("ngSubmit",function(){return n.submit()}),e.TgZ(2,"div",2)(3,"label"),e._uU(4,"Review: "),e.TgZ(5,"input",3,4),e.NdJ("ngModelChange",function(v){return n.review.content=v}),e.qZA()(),e.TgZ(7,"button",5),e._uU(8,"Add Review"),e.qZA()(),e.YNc(9,C,3,2,"div",6),e.qZA()),2&t){const l=e.MAs(1),v=e.MAs(6);e.xp6(5),e.Q6J("ngModel",n.review.content),e.xp6(2),e.Q6J("disabled",!l.form.valid),e.xp6(2),e.Q6J("ngIf",!(v.valid||v.pristine))}},directives:[s._Y,s.JL,s.F,s.Fj,s.wO,s.Q7,s.JJ,s.On,a.O5],styles:[""]}),o})();function I(o,i){if(1&o&&(e.TgZ(0,"div",6),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" Sorry, there's been an error communicating with the server: ",t.errorMessage,"\n")}}function T(o,i){if(1&o&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA()()),2&o){const t=i.$implicit;e.xp6(2),e.Oqu(t.content)}}const F=[{path:":id",component:(()=>{class o{constructor(t,n){this.route=t,this.reviewService=n,this.bookId=-1,this.errorMessage=""}showError(t){this.errorMessage=t.message?t.message:t.status?`${t.status} - ${t.statusText}`:"Server error"}getReviews(){this.reviewService.getReviews(this.bookId).pipe((0,u.K)(t=>(this.showError(t),(0,d.of)([])))).subscribe(t=>this.reviews=t)}getBook(){this.reviewService.getBook(this.bookId).pipe((0,u.K)(t=>(this.showError(t),(0,d.of)(new g.f("","","",0))))).subscribe(t=>this.book=t)}addReview(t){t.bookId=this.bookId,this.reviewService.addReview(t).pipe((0,u.K)(n=>(this.showError(n),(0,d.of)(new w("",0))))).subscribe(n=>this.reviews.push(n))}ngOnInit(){const t=this.route.snapshot.paramMap.get("id");t&&(this.bookId=+t,this.getReviews(),this.getBook())}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(c.gz),e.Y36(f))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-review-list"]],decls:13,vars:4,consts:[[3,"bookId","createReview"],["class","alert alert-danger",4,"ngIf"],[1,"row"],[1,"col-lg-8","col-sm-offset-1"],[1,"table","table-bordered","table-striped"],[4,"ngFor","ngForOf"],[1,"alert","alert-danger"]],template:function(t,n){1&t&&(e.TgZ(0,"h1"),e._uU(1),e.qZA(),e.TgZ(2,"app-review-form",0),e.NdJ("createReview",function(v){return n.addReview(v)}),e.qZA(),e.YNc(3,I,2,1,"div",1),e.TgZ(4,"div",2)(5,"div",3)(6,"table",4)(7,"thead")(8,"tr")(9,"th"),e._uU(10,"Review"),e.qZA()()(),e.TgZ(11,"tbody"),e.YNc(12,T,3,1,"tr",5),e.qZA()()()()),2&t&&(e.xp6(1),e.hij("Reviews for ",null==n.book?null:n.book.title,""),e.xp6(1),e.Q6J("bookId",n.bookId),e.xp6(1),e.Q6J("ngIf",n.errorMessage),e.xp6(9),e.Q6J("ngForOf",n.reviews))},directives:[Z,a.O5,a.sg],styles:[""]}),o})(),data:{animation:"reviewPage"}}];let M=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[c.Bz.forChild(F)],c.Bz]}),o})(),k=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[a.ez,M,s.u5]]}),o})()}}]);